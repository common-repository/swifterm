<html>

	<head>
		<title>SwiftAPI Specification</title>

		<style>
			body
				{
				font-family: sans-serif;
				color: #333;
				}

			table
				{
				border-collapse: collapse;
				}

			thead
				{
				background-color: LightSteelBlue;
				border-bottom: 3px double Gray;
				}

			td, th
				{
				border:1px solid Gray;
				padding: 0.2em;
				}
		</style>

	</head>

	<body>

		<h1>SwiftAPI Specification</h1>

		<h2>Version</h2>
		<p>3</p>

		<h2>Overview</h2>
		<p>This document details the operations, transfer method, fields, and encryption scheme used to implement the SwiftAPI.</p>

		<h2 id="Operations">Operations</h2>
		<table>
			<thead>
				<tr>
					<th>Operation</th>
					<th>Incoming / Outgoing to Plugin Operation</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>home</td>
					<td>outgoing</td>
					<td>A user visits the website's homepage.</td>
				</tr>
				<tr>
					<td>product</td>
					<td>outgoing</td>
					<td>A user visits a product details page - a page that lists all information about a single product.</td>
				</tr>
				<tr>
					<td>cart</td>
					<td>outgoing</td>
					<td>A user adds products to the shopping cart.</td>
				</tr>
				<tr>
					<td>order</td>
					<td>outgoing</td>
					<td>A user successfully places an order on the website.</td>
				</tr>
				<tr>
					<td>pastorder</td>
					<td>outgoing</td>
					<td>When a client first sets up the plugin on their website it will send all historical order data to the Swift system, unless the client decides to opt out.</td>
				</tr>
				<tr>
					<td>subscription</td>
					<td>outgoing</td>
					<td>A user submits their email address to join a newsletter using Magento's standard newsletter subscription feature.</td>
				</tr>
				<tr>
					<td>viewmail</td>
					<td>n/a</td>
					<td>A user accesses the website via a link in one of the SwiftERM system's emails.</td>
				</tr>
				<tr>
					<td>unsubscribe</td>
					<td>n/a</td>
					<td>A user unsubscribes from the SwiftERM system the system will not send them anymore emails.</td>
				</tr>
				<tr>
					<td>emailpackage</td>
					<td>incoming</td>
					<td>The SwiftERM system has generated a series of emails to be sent by a client's site.</td>
				</tr>
				<tr>
					<td>sendmail</td>
					<td>incoming via emailpackage</td>
					<td>The Swift system has generated an email to be sent by a client's site.</td>
				</tr>
				<tr>
					<td>ping</td>
					<td>outgoing</td>
					<td>Upon registration, it tells SwiftERM that the plugin is ready to send data.</td>
				</tr>
			</tbody>
		</table>

		<h2>Transfer Method</h2>
		<p>Requests to the API will be send via <strong>HTTPS POST</strong>.</p>

		<h2>POST Format</h2>
		<table>
			<thead>
				<tr>
					<th>Key</th>
					<th>Data Type</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>version</td>
					<td>Integer</td>
					<td>The API version number.</td>
				</tr>
				<tr>
					<td>domain</td>
					<td>String</td>
					<td>The domain name of the SwiftERM clients site.</td>
				</tr>
				<tr>
					<td>data</td>
					<td>String</td>
					<td>A <strong>base64</strong> encoded string containing an <strong>AES-256</strong> initialization vector followed by a <strong>AES-256</strong> encrypted <strong>JSON</strong> object comprised of the <a href="#DataFields">Data Fields</a> listed below.</td>
				</tr>
			</tbody>
		</table>

		<h2 id="DataFields">Data Fields</h2>
		<table>
			<thead>
				<tr>
					<th>Field</th>
					<th>Data Type</th>
					<th>Required for Operations</th>
					<th>Optional for Operations</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>domain</td>
					<td>String</td>
					<td>ALL</td>
					<td></td>
					<td>The domain name of the SwiftERM clients site. (This is required to be duplicated in the data section to prevent forged requests.)</td>
				</tr>
				<tr>
					<td>date</td>
					<td>String - <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601 Date</a></td>
					<td>ALL</td>
					<td></td>
					<td>An ISO Date when the request was generated in the format YYYY-MM-DDThh:mm e.g. 2007-04-05T14:30</td>
				</tr>
				<tr>
					<td>operation</td>
					<td>String - <a href="#Operations">SwiftAPI Operation ID</a></td>
					<td>ALL</td>
					<td></td>
					<td>One of the <a href="#Operations">SwiftAPI operation ID's</a></td>
				</tr>
				<tr>
					<td>user</td>
					<td>String - <a href="http://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a></td>
					<td>ALL</td>
					<td></td>
					<td>A universally unique identifier generated by the SwiftERM client site/plugin used to identify a user over the duration of their visit to a site.</td>
				</tr>
				<tr>
					<td>url</td>
					<td>String</td>
					<td>home</td>
					<td></td>
					<td>The URL of the page where the API request was triggered.</td>
				</tr>
				<tr>
					<td>email</td>
					<td>String</td>
					<td>order, pastorder, subscription, viewmail, sendmail, unsubscribe</td>
					<td>home, product, cart</td>
					<td>The users email address.</td>
				</tr>
				<tr>
					<td>forename</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The users forename.</td>
				</tr>
				<tr>
					<td>surname</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The users surname.</td>
				<tr>
					<td>product</td>
					<td>String</td>
					<td>product, viewmail</td>
					<td></td>
					<td>A site specific product identifier (Should correspond to ID's provided in the sites 'product XML file').</td>
				</tr>
				<tr>
					<td>products</td>
					<td>Array</td>
					<td>cart, order, pastorder</td>
					<td></td>
					<td>An array of JSON objects containing <a href="#ProductFields">Product Fields</a>.</td>
				</tr>
				<tr>
					<td>subject</td>
					<td>String</td>
					<td>sendmail</td>
					<td></td>
					<td>Message subject for a swift email.</td>
				</tr>
				<tr>
					<td>body</td>
					<td>String</td>
					<td>sendmail</td>
					<td></td>
					<td>Message content for a swift email.</td>
				</tr>
				<tr>
					<td>orderId</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The client system's unique order identifier, typically an order Id</td>
				</tr>
				<tr>
					<td>orderStatus</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The client system order's current status of an order</td>
				</tr>
				<tr>
					<td>emailId</td>
					<td>String</td>
					<td>viewmail, sendmail</td>
					<td></td>
					<td>The system identifier to identify what email was clicked on.</td>
				</tr>
				<tr>
					<td>monitor</td>
					<td>String</td>
					<td>sendmail</td>
					<td></td>
					<td>If present, the client site shall also send an email to the email address specified in the field.</td>
				</tr>
				<tr>
					<td>key</td>
					<td>String</td>
					<td>ping</td>
					<td></td>
					<td>The Site Key that the SwiftERM has generated.</td>
				</tr>
				<tr>
					<td>emailPackage</td>
					<td>String</td>
					<td>emailpackage</td>
					<td></td>
					<td>Contains a collection of sendmail packages that were sent from the SwiftERM system.</td>
				</tr>
				<tr>
					<td>site</td>
					<td>String</td>
					<td>emailpackage</td>
					<td></td>
					<td>Contains a site unique identifier in the SwiftERM system.</td>
				</tr>
				<tr>
					<td>is_mail_function</td>
					<td>String</td>
					<td>emailpackage</td>
					<td></td>
					<td>Tells the plugin to use mail function rather than smtp, if present.</td>
				</tr>
			</tbody>
		</table>

		<h2 id="ProductFields">Product Fields</h2>
		<table>
			<thead>
				<tr>
					<th>Field</th>
					<th>Data Type</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>product</td>
					<td>String</td>
					<td>A site specific product identifier (Should correspond to ID's provided in the sites 'product XML file').</td>
				</tr>
				<tr>
					<td>quantity</td>
					<td>Integer</td>
					<td>The number of products in the order.</td>
				</tr>
				<tr>
					<td>price</td>
					<td>String</td>
					<td>The product price (May potentially differ from the value specified in the sites 'product XML file').</td>
				</tr>
			</tbody>
		</table>

	</body>

</html>